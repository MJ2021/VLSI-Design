library ieee; 
use ieee.std_logic_1164.all;

entity brent_kung_adder is
    port (A, B : in std_logic_vector(15 downto 0); C0: in std_logic ; Sum : out std_logic_vector(15 downto 0); Carry : out std_logic );
end entity brent_kung_adder;


architecture simple of brent_kung_adder is
    component Level_1 port (A, B : in std_logic_vector(15 downto 0) ; P1, G1 : out std_logic_vector(15 downto 0) );
    end component;
    component Level_2 port (P_1, G_1 : in std_logic_vector(15 downto 0) ; P2, G2 : out std_logic_vector(7 downto 0) );
    end component;
    component Level_3 port (P_2, G_2 : in std_logic_vector(7 downto 0) ; P3, G3 : out std_logic_vector(3 downto 0) );
    end component;
    component Level_4 port (P_3, G_3 : in std_logic_vector(3 downto 0) ; P4, G4 : out std_logic_vector(1 downto 0) );
    end component;
    component Level_5 port (P_4, G_4 : in std_logic_vector(1 downto 0) ; P5, G5 : out std_logic );
    end component;
    component a_and_bc port(data_a, data_b, data_c: in std_logic; data_out : out std_logic);
    end component;
    component xor2 port(data_in_0, data_in_1: in std_logic; data_out: out std_logic);
    end component;
    component Cin_map_G port(A, B, Cin: in std_ulogic;Bit0_G: out std_ulogic);
    end component;
   -- carry generators
    signal Cout : std_logic_vector(16 downto 1);
    signal p_level1, g_level1 : std_logic_vector(15 downto 0);
    signal p_level2, g_level2 : std_logic_vector(7 downto 0);
    signal p_level3, g_level3 : std_logic_vector(3 downto 0);
    signal p_level4, g_level4 : std_logic_vector(1 downto 0);
    signal p_level5, g_level5 : std_logic;
  

begin

   -- calculating generation and propagation terms
    l1: Level_1 port map ( A => A , B => B , P1 => p_level1 , G1 => g_level1 );
    l2: Level_2 port map ( P_1 => p_level1 , G_1 => g_level1 , P2 => p_level2 , G2 => g_level2 );
    l3: Level_3 port map ( P_2 => p_level2 , G_2 => g_level2 , P3 => p_level3 , G3 => g_level3 );
    l4: Level_4 port map ( P_3 => p_level3 , G_3 => g_level3 , P4 => p_level4 , G4 => g_level4 );
    l5: Level_5 port map ( P_4 => p_level4 , G_4 => g_level4 , P5 => p_level5 , G5 => g_level5 );
    

   -- calculating carry bits

   -- level1 
    c1: Cin_map_G port map (A =>g_level1(0) ,  B=>p_level1(0) , Cin=>C0 , Bit0_G=>Cout(1));
    c2: Cin_map_G port map (A =>g_level2(0) ,  B=>p_level2(0) , Cin=>C0 , Bit0_G=>Cout(2));
    c4: Cin_map_G port map (A=>g_level3(0) ,  B=>p_level3(0) , Cin=>C0 , Bit0_G=>Cout(4));
    c8: Cin_map_G port map (A=>g_level4(0) ,  B=>p_level4(0) , Cin=>C0 , Bit0_G=>Cout(8));
    c16: Cin_map_G port map (A =>g_level5 ,  B=>p_level5 , Cin=>C0 , Bit0_G=>Carry);
    
   -- level2 
    c3: a_and_bc port map (data_a=>g_level1(2) , data_b=>p_level1(2) , data_c=>Cout(2) , data_out=>Cout(3));
    c5: a_and_bc port map (data_a=>g_level1(4) , data_b=>p_level1(4) , data_c=>Cout(4) , data_out=>Cout(5));
    c6: a_and_bc port map (data_a=>g_level2(2) , data_b=>p_level2(2) , data_c=>Cout(4) , data_out=>Cout(6));
    c9: a_and_bc port map (data_a=>g_level1(8) , data_b=>p_level1(8) , data_c=>Cout(8) , data_out=>Cout(9));
    c10: a_and_bc port map (data_a=>g_level2(4) , data_b=>p_level2(4) , data_c=>Cout(8) , data_out=>Cout(10));
    c12: a_and_bc port map (data_a=>g_level3(2) , data_b=>p_level3(2) , data_c=>Cout(8) , data_out=>Cout(12));
    
   -- level3 
    c7: a_and_bc port map (data_a=>g_level1(6) , data_b=>p_level1(6) , data_c=>Cout(6) , data_out=>Cout(7));
    c11: a_and_bc port map (data_a=>g_level1(10) , data_b=>p_level1(10) , data_c=>Cout(10) , data_out=>Cout(11));
    c13: a_and_bc port map (data_a=>g_level1(12) , data_b=>p_level1(12) , data_c=>Cout(12) , data_out=>Cout(13));
    c14: a_and_bc port map (data_a=>g_level2(6) , data_b=>p_level2(6) , data_c=>Cout(12) , data_out=>Cout(14));
    
   -- level4 
    c15: a_and_bc port map (data_a=>g_level1(14) , data_b=>p_level1(14) , data_c=>Cout(14) , data_out=>Cout(15));
    
    


   -- generating sum
    s0: xor2 port map (data_in_0=>p_level1(0) , data_in_1=>C0 , data_out=>Sum(0));
    s1: xor2 port map (data_in_0=>p_level1(1) , data_in_1=>Cout(1) , data_out=>Sum(1));
    s2: xor2 port map (data_in_0=>p_level1(2) , data_in_1=>Cout(2) , data_out=>Sum(2));
    s3: xor2 port map (data_in_0=>p_level1(3) , data_in_1=>Cout(3) , data_out=>Sum(3));
    s4: xor2 port map (data_in_0=>p_level1(4) , data_in_1=>Cout(4) , data_out=>Sum(4));
    s5: xor2 port map (data_in_0=>p_level1(5) , data_in_1=>Cout(5) , data_out=>Sum(5));
    s6: xor2 port map (data_in_0=>p_level1(6) , data_in_1=>Cout(6) , data_out=>Sum(6));
    s7: xor2 port map (data_in_0=>p_level1(7) , data_in_1=>Cout(7) , data_out=>Sum(7));
    s8: xor2 port map (data_in_0=>p_level1(8) , data_in_1=>Cout(8) , data_out=>Sum(8));
    s9: xor2 port map (data_in_0=>p_level1(9) , data_in_1=>Cout(9) , data_out=>Sum(9));
    s10: xor2 port map (data_in_0=>p_level1(10) , data_in_1=>Cout(10) , data_out=>Sum(10));
    s11: xor2 port map (data_in_0=>p_level1(11) , data_in_1=>Cout(11) , data_out=>Sum(11));
    s12: xor2 port map (data_in_0=>p_level1(12) , data_in_1=>Cout(12) , data_out=>Sum(12));
    s13: xor2 port map (data_in_0=>p_level1(13) , data_in_1=>Cout(13) , data_out=>Sum(13));
    s14: xor2 port map (data_in_0=>p_level1(14) , data_in_1=>Cout(14) , data_out=>Sum(14));
    s15: xor2 port map (data_in_0=>p_level1(15) , data_in_1=>Cout(15) , data_out=>Sum(15));
    
    
end simple;